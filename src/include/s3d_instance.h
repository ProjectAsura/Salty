//-------------------------------------------------------------------------------------------------
// File : s3d_instance.h
// Desc : Instance Module.
// Copyright(c) Project Asura. All right reserved.
//-------------------------------------------------------------------------------------------------

#ifndef __S3D_INSTANCE_H__
#define __S3D_INSTANCE_H__

//-------------------------------------------------------------------------------------------------
// Includes
//-------------------------------------------------------------------------------------------------
#include <s3d_shape.h>


namespace s3d {

///////////////////////////////////////////////////////////////////////////////////////////////////
// Instance class
///////////////////////////////////////////////////////////////////////////////////////////////////
class Instance : public IShape
{
    //=============================================================================================
    // list of friend classes and methods.
    //=============================================================================================
    /* NOTHING */

public:
    //=============================================================================================
    // public variables.
    //=============================================================================================
    /* NOTHING */

    //=============================================================================================
    // public methods.
    //=============================================================================================

    //---------------------------------------------------------------------------------------------
    //! @brief      コンストラクタです.
    //---------------------------------------------------------------------------------------------
    explicit Instance( const IShape* shape, const Matrix& world );

    //---------------------------------------------------------------------------------------------
    //! @brief      デストラクタです.
    //---------------------------------------------------------------------------------------------
    virtual ~Instance();

    //---------------------------------------------------------------------------------------------
    //! @brief      交差判定を行います.
    //---------------------------------------------------------------------------------------------
    bool IsHit( const Ray& ray, HitRecord& record ) const override;

    //---------------------------------------------------------------------------------------------
    //! @brief      基本図形かどうかチェックします.
    //---------------------------------------------------------------------------------------------
    bool IsPrimitive() const override;

    //---------------------------------------------------------------------------------------------
    //! @brief      バウンディングボックスを取得します.
    //---------------------------------------------------------------------------------------------
    BoundingBox GetBox() const override;

    //---------------------------------------------------------------------------------------------
    //! @brief      マテリアルを取得します.
    //---------------------------------------------------------------------------------------------
    const IMaterial* GetMaterial() const override;

    //---------------------------------------------------------------------------------------------
    //! @brief      中心座標を取得します.
    //---------------------------------------------------------------------------------------------
    Vector3 GetCenter() const override;

private:
    //=============================================================================================
    // private variables.
    //=============================================================================================
    const IShape*   m_pShape;
    Matrix          m_World;
    Matrix          m_InvWorld;
    BoundingBox     m_WorldBox;
    Vector3         m_WorldCenter;

    //=============================================================================================
    // private methods.
    //=============================================================================================
    /* NOTHING */
};


} // namespace s3d

#endif//__S3D_INSTANCE_H__
