//---------------------------------------------------------------------------------
// File : s3d_scene.h
// Desc : Scene Module.
// Copyright(c) Project Asura. All right reserved.
//---------------------------------------------------------------------------------

#ifndef __S3D_SCENE_H__
#define __S3D_SCENE_H__

//---------------------------------------------------------------------------------
// Includes
//---------------------------------------------------------------------------------
#include <s3d_typedef.h>
#include <s3d_shape.h>
#include <s3d_material.h>
#include <s3d_camera.h>
#include <s3d_texture.h>


namespace s3d {

///////////////////////////////////////////////////////////////////////////////////
// Scene class
///////////////////////////////////////////////////////////////////////////////////
class Scene
{
    //=============================================================================
    // list of friend classes and methods.
    //=============================================================================
    /* NOTHING */

public:
    //=============================================================================
    // public variables.
    //=============================================================================
    /* NOTHING */

    //=============================================================================
    // public methods.
    //=============================================================================

    //-----------------------------------------------------------------------------
    //! @brief      コンストラクタです.
    //-----------------------------------------------------------------------------
    Scene();

    //-----------------------------------------------------------------------------
    //! @brief      デストラクタです.
    //-----------------------------------------------------------------------------
    ~Scene();

    //-----------------------------------------------------------------------------
    //! @brief      クリアします.
    //-----------------------------------------------------------------------------
    void Clear();

    //-----------------------------------------------------------------------------
    //! @brief      ファイルから読み込みます.
    //-----------------------------------------------------------------------------
    bool LoadFromFile( const char* filename );

    //-----------------------------------------------------------------------------
    //! @brief      交差判定を行います.
    //-----------------------------------------------------------------------------
    bool Intersect( const Ray& ray, HitRecord& record );

    //-----------------------------------------------------------------------------
    //! @brief      レイを取得します.
    //-----------------------------------------------------------------------------
    Ray  GetRay( const f32 x, const f32 y );

protected:
    //=============================================================================
    // protected variables.
    //=============================================================================
    /* NOTHING */

    //=============================================================================
    // protected methods.
    //=============================================================================
    /* NOTHING */

private:
    //=============================================================================
    // private variables.
    //=============================================================================
    u32             m_NumShapes;            //!< シェイプ数です.
    u32             m_NumMaterials;         //!< マテリアル数です.
    u32             m_NumTextures;          //!< テクスチャ数です.
    u32             m_NumSamplers;          //!< テクスチャサンプラー数です.
    IShape**        m_ppShapes;             //!< シェイプです.
    IMaterial**     m_ppMaterials;          //!< マテリアルです.
    Texture2D*      m_pTextures;            //!< テクスチャです.
    TextureSampler* m_pSamplers;            //!< テクスチャサンプラーです.
    Camera*         m_pCamera;              //!< カメラです.
    IShape*         m_pBVH;                 //!< シーンのBVHです.

    //=============================================================================
    // private methods.
    //=============================================================================
    /* NOTHING */
};

} // namespace s3d


#endif//__S3D_SCENE_H__
